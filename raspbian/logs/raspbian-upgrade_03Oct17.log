1. 执行 `sudo vim /etc/apt/sources.list`，注释掉原来的 `deb http://... stretch main contrib non-free rpi`，添加中科大的 deb 和 deb-src。

```Shell
pi@raspberrypi:~$ cat /etc/apt/sources.list
# comment by thomasfan, 27Sept17.
#deb http://mirrordirector.raspbian.org/raspbian/ stretch main contrib non-free rpi
# Uncomment line below then 'apt-get update' to enable 'apt-get source'
#deb-src http://archive.raspbian.org/raspbian/ stretch main contrib non-free rpi

#中科大
deb http://mirrors.ustc.edu.cn/raspbian/raspbian/ stretch main contrib non-free rpi
deb-src http://mirrors.ustc.edu.cn/raspbian/raspbian/ stretch main contrib non-free rpi

```

2. 执行 `sudo vim /etc/apt/sources.list.d/raspi.list`，注释掉原来的 `deb http://... stretch main ui`，添加中科大的 deb 和 deb-src。

```Shell
pi@raspberrypi:~$ cat /etc/apt/sources.list.d/raspi.list
# comment by homasfan, 03Oct17.
#deb http://archive.raspberrypi.org/debian/ stretch main ui
# Uncomment line below then 'apt-get update' to enable 'apt-get source'
#deb-src http://archive.raspberrypi.org/debian/ stretch main ui

#中科大
deb http://mirrors.ustc.edu.cn/archive.raspberrypi.org/ stretch main ui
deb-src http://mirrors.ustc.edu.cn/archive.raspberrypi.org/ stretch main ui

```

---

pi@raspberrypi:~$ sudo rm -vf /var/lib/apt/lists/*
removed '/var/lib/apt/lists/lock'
removed '/var/lib/apt/lists/mirrors.ustc.edu.cn_raspbian_raspbian_dists_wheezy_contrib_binary-armhf_Packages'
removed '/var/lib/apt/lists/mirrors.ustc.edu.cn_raspbian_raspbian_dists_wheezy_contrib_source_Sources'
removed '/var/lib/apt/lists/mirrors.ustc.edu.cn_raspbian_raspbian_dists_wheezy_InRelease'
removed '/var/lib/apt/lists/mirrors.ustc.edu.cn_raspbian_raspbian_dists_wheezy_main_binary-armhf_Packages'
removed '/var/lib/apt/lists/mirrors.ustc.edu.cn_raspbian_raspbian_dists_wheezy_main_source_Sources'
removed '/var/lib/apt/lists/mirrors.ustc.edu.cn_raspbian_raspbian_dists_wheezy_non-free_binary-armhf_Packages'
removed '/var/lib/apt/lists/mirrors.ustc.edu.cn_raspbian_raspbian_dists_wheezy_non-free_source_Sources'
rm: cannot remove '/var/lib/apt/lists/partial': Is a directory
pi@raspberrypi:~$ sudo mkdir -pv /var/lib/apt/lists/partial
pi@raspberrypi:~$ sudo apt-get clean
pi@raspberrypi:~$ sudo apt-get update
Get:1 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch InRelease [15.0 kB]
Get:2 http://mirrors.ustc.edu.cn/archive.raspberrypi.org stretch InRelease [25.3 kB]
Get:3 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/contrib Sources [75.1 kB]
Get:4 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/rpi Sources [1,132 B]
Get:5 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main Sources [9,739 kB]
Get:6 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/non-free Sources [125 kB]
Get:7 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf Packages [11.7 MB]
Get:8 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/contrib armhf Packages [56.8 kB]
Get:9 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/non-free armhf Packages [95.2 kB]
Get:10 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/rpi armhf Packages [1,360 B]
Get:11 http://mirrors.ustc.edu.cn/archive.raspberrypi.org stretch/ui Sources [13.2 kB]
Get:12 http://mirrors.ustc.edu.cn/archive.raspberrypi.org stretch/main Sources [37.0 kB]
Get:13 http://mirrors.ustc.edu.cn/archive.raspberrypi.org stretch/main armhf Packages [117 kB]
Get:14 http://mirrors.ustc.edu.cn/archive.raspberrypi.org stretch/ui armhf Packages [26.9 kB]
Fetched 22.0 MB in 1min 5s (336 kB/s)                                          
Reading package lists... Done
pi@raspberrypi:~$ sudo apt-get upgrade
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Calculating upgrade... Done
The following packages were automatically installed and are no longer required:
  fonts-arphic-bsmi00lp fonts-arphic-gbsn00lp liblcms1 libscim8v5
  scim-im-agent scim-modules-socket
Use 'sudo apt autoremove' to remove them.
The following packages have been kept back:
  fcitx-bin fcitx-config-common fcitx-config-gtk fcitx-frontend-all
  fcitx-frontend-gtk2 fcitx-frontend-gtk3 fcitx-frontend-qt4 fcitx-libs
  fcitx-module-lua fcitx-modules libpresage-data libqt4-dbus libqt4-xml
  libqtcore4 libqtdbus4 libqtgui4 presage qdbus vim vim-common vim-runtime
The following packages will be upgraded:
  fcitx fcitx-data fcitx-module-dbus fcitx-module-kimpanel fcitx-module-x11
  fcitx-ui-classic git git-man libidn2-0 libjpeg8 liblcms1 liblua5.1-0 libmng1
  libtiff4 linux-libc-dev python-pip python-pip-whl python3-pip raspi-config
  realvnc-vnc-server realvnc-vnc-viewer
21 upgraded, 0 newly installed, 0 to remove and 21 not upgraded.
Need to get 16.9 MB of archives.
After this operation, 2,129 kB of additional disk space will be used.
Do you want to continue? [Y/n] Y
Get:1 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf git-man all 1:2.11.0-3+deb9u2 [1,432 kB]
Get:2 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf git armhf 1:2.11.0-3+deb9u2 [3,380 kB]
Get:3 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf libjpeg8 armhf 8d1-2 [108 kB]
Get:4 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf liblcms1 armhf 1.19.dfsg2-1.5 [79.7 kB]
Get:5 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf libmng1 armhf 1.0.10+dfsg-3.1 [164 kB]
Get:6 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf libtiff4 armhf 3.9.7-3 [190 kB]
Get:7 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf fcitx-module-dbus armhf 1:4.2.9.1-6 [47.4 kB]
Get:8 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf fcitx all 1:4.2.9.1-6 [26.7 kB]
Get:9 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf fcitx-ui-classic armhf 1:4.2.9.1-6 [127 kB]
Get:10 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf fcitx-data all 1:4.2.9.1-6 [170 kB]
Get:11 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf fcitx-module-kimpanel armhf 1:4.2.9.1-6 [38.3 ]
Get:12 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf fcitx-module-x11 armhf 1:4.2.9.1-6 [90.9 kB]
Get:13 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf liblua5.1-0 armhf 5.1.5-8.1 [83.3 kB]
Get:14 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf linux-libc-dev armhf 4.9.30-2+deb9u2+rpi1+stre]
Get:15 http://mirrors.ustc.edu.cn/archive.raspberrypi.org stretch/main armhf python3-pip all 9.0.1-2+rpt1 [142 kB]
Get:16 http://mirrors.ustc.edu.cn/archive.raspberrypi.org stretch/main armhf python-pip all 9.0.1-2+rpt1 [179 kB]
Get:17 http://mirrors.ustc.edu.cn/archive.raspberrypi.org stretch/main armhf python-pip-whl all 9.0.1-2+rpt1 [1,399 k]
Get:18 http://mirrors.ustc.edu.cn/archive.raspberrypi.org stretch/main armhf realvnc-vnc-server armhf 6.2.0.29523 [5,]
Get:19 http://mirrors.ustc.edu.cn/archive.raspberrypi.org stretch/main armhf realvnc-vnc-viewer armhf 6.17.731.29523 ]
Get:20 http://mirrors.ustc.edu.cn/raspbian/raspbian stretch/main armhf libidn2-0 armhf 0.16-1+deb9u1 [59.5 kB]
Get:21 http://mirrors.ustc.edu.cn/archive.raspberrypi.org stretch/main armhf raspi-config all 20170926 [18.8 kB]
Fetched 16.9 MB in 14s (1,137 kB/s)                                            
Reading changelogs... Done
(Reading database ... 125113 files and directories currently installed.)
Preparing to unpack .../00-git-man_1%3a2.11.0-3+deb9u2_all.deb ...
Unpacking git-man (1:2.11.0-3+deb9u2) over (1:2.11.0-3) ...
Preparing to unpack .../01-git_1%3a2.11.0-3+deb9u2_armhf.deb ...
Unpacking git (1:2.11.0-3+deb9u2) over (1:2.11.0-3) ...
Preparing to unpack .../02-libjpeg8_8d1-2_armhf.deb ...
Unpacking libjpeg8:armhf (8d1-2) over (8d-1+deb7u1) ...
Preparing to unpack .../03-liblcms1_1.19.dfsg2-1.5_armhf.deb ...
Unpacking liblcms1:armhf (1.19.dfsg2-1.5) over (1.19.dfsg2-1.2+deb7u1) ...
Preparing to unpack .../04-libmng1_1.0.10+dfsg-3.1_armhf.deb ...
Unpacking libmng1:armhf (1.0.10+dfsg-3.1) over (1.0.10-3) ...
Preparing to unpack .../05-libtiff4_3.9.7-3_armhf.deb ...
Unpacking libtiff4:armhf (3.9.7-3) over (3.9.6-11+deb7u8) ...
Preparing to unpack .../06-fcitx-module-dbus_1%3a4.2.9.1-6_armhf.deb ...
Unpacking fcitx-module-dbus (1:4.2.9.1-6) over (1:4.2.4.1-7) ...
Preparing to unpack .../07-fcitx_1%3a4.2.9.1-6_all.deb ...
Unpacking fcitx (1:4.2.9.1-6) over (1:4.2.4.1-7) ...
Preparing to unpack .../08-fcitx-ui-classic_1%3a4.2.9.1-6_armhf.deb ...
Unpacking fcitx-ui-classic (1:4.2.9.1-6) over (1:4.2.4.1-7) ...
Preparing to unpack .../09-fcitx-data_1%3a4.2.9.1-6_all.deb ...
Unpacking fcitx-data (1:4.2.9.1-6) over (1:4.2.4.1-7) ...
Preparing to unpack .../10-fcitx-module-kimpanel_1%3a4.2.9.1-6_armhf.deb ...
Unpacking fcitx-module-kimpanel (1:4.2.9.1-6) over (1:4.2.4.1-7) ...
Preparing to unpack .../11-fcitx-module-x11_1%3a4.2.9.1-6_armhf.deb ...
Unpacking fcitx-module-x11 (1:4.2.9.1-6) over (1:4.2.4.1-7) ...
Preparing to unpack .../12-liblua5.1-0_5.1.5-8.1_armhf.deb ...
Unpacking liblua5.1-0:armhf (5.1.5-8.1) over (5.1.5-4+deb7u1) ...
Preparing to unpack .../13-linux-libc-dev_4.9.30-2+deb9u2+rpi1+stretch_armhf.deb ...
Unpacking linux-libc-dev:armhf (4.9.30-2+deb9u2+rpi1+stretch) over (3.18.5-1~exp1+rpi19+stretch) ...
Preparing to unpack .../14-python3-pip_9.0.1-2+rpt1_all.deb ...
Unpacking python3-pip (9.0.1-2+rpt1) over (9.0.1-2) ...
Preparing to unpack .../15-python-pip_9.0.1-2+rpt1_all.deb ...
Unpacking python-pip (9.0.1-2+rpt1) over (9.0.1-2) ...
Preparing to unpack .../16-python-pip-whl_9.0.1-2+rpt1_all.deb ...
Unpacking python-pip-whl (9.0.1-2+rpt1) over (9.0.1-2) ...
Preparing to unpack .../17-realvnc-vnc-server_6.2.0.29523_armhf.deb ...

(gconftool-2:1734): GConf-WARNING **: Client failed to connect to the D-BUS daemon:
Unable to autolaunch a dbus-daemon without a $DISPLAY for X11
Unpacking realvnc-vnc-server (6.2.0.29523) over (6.1.1.28093) ...
Preparing to unpack .../18-realvnc-vnc-viewer_6.17.731.29523_armhf.deb ...
Unpacking realvnc-vnc-viewer (6.17.731.29523) over (6.1.1.28093) ...
Preparing to unpack .../19-libidn2-0_0.16-1+deb9u1_armhf.deb ...
Unpacking libidn2-0:armhf (0.16-1+deb9u1) over (0.16-1) ...
Preparing to unpack .../20-raspi-config_20170926_all.deb ...
Unpacking raspi-config (20170926) over (20170811) ...
Setting up python-pip-whl (9.0.1-2+rpt1) ...
Setting up git-man (1:2.11.0-3+deb9u2) ...
Setting up fcitx-module-dbus (1:4.2.9.1-6) ...
Setting up libidn2-0:armhf (0.16-1+deb9u1) ...
Processing triggers for gconf2 (3.2.6-4) ...
Setting up fcitx-data (1:4.2.9.1-6) ...
Processing triggers for mime-support (3.60) ...
Processing triggers for desktop-file-utils (0.23-1) ...
Setting up realvnc-vnc-viewer (6.17.731.29523) ...
Setting up linux-libc-dev:armhf (4.9.30-2+deb9u2+rpi1+stretch) ...
Processing triggers for gnome-icon-theme (3.12.0-2) ...
Setting up liblcms1:armhf (1.19.dfsg2-1.5) ...
Setting up realvnc-vnc-server (6.2.0.29523) ...
Updating /etc/pam.d/vncserver
Updating /etc/pam.conf... done
Original config file "/etc/vnc/xstartup.old" preserved
Looking for font path... not found.
Original config file "/etc/vnc/vncelevatecfg.old" preserved
Installed systemd unit for VNC Server in Service Mode daemon
Start or stop the service with:
  systemctl (start|stop) vncserver-x11-serviced.service
Mark or unmark the service to be started at boot time with:
  systemctl (enable|disable) vncserver-x11-serviced.service

Installed systemd unit for VNC Server in Virtual Mode daemon
Start or stop the service with:
  systemctl (start|stop) vncserver-virtuald.service
Mark or unmark the service to be started at boot time with:
  systemctl (enable|disable) vncserver-virtuald.service


(gconftool-2:1942): GConf-WARNING **: Client failed to connect to the D-BUS daemon:
Unable to autolaunch a dbus-daemon without a $DISPLAY for X11
gconfd-2: no process found
Setting up raspi-config (20170926) ...
Processing triggers for libc-bin (2.24-11+deb9u1) ...
Processing triggers for systemd (232-25+deb9u1) ...
Setting up python3-pip (9.0.1-2+rpt1) ...
Processing triggers for man-db (2.7.6.1-2) ...
Processing triggers for shared-mime-info (1.8-1) ...
Setting up liblua5.1-0:armhf (5.1.5-8.1) ...
Setting up fcitx-module-x11 (1:4.2.9.1-6) ...
Processing triggers for gnome-menus (3.13.3-9) ...
Setting up python-pip (9.0.1-2+rpt1) ...
Processing triggers for hicolor-icon-theme (0.15-1) ...
Setting up fcitx-module-kimpanel (1:4.2.9.1-6) ...
Setting up git (1:2.11.0-3+deb9u2) ...
Setting up libjpeg8:armhf (8d1-2) ...
Setting up fcitx (1:4.2.9.1-6) ...
update-alternatives: using /etc/X11/xinit/xinput.d/fcitx to provide /etc/X11/xinit/xinput.d/ja_JP (xinput-ja_JP) in ae
update-alternatives: using /etc/X11/xinit/xinput.d/fcitx to provide /etc/X11/xinit/xinput.d/ko_KR (xinput-ko_KR) in ae
update-alternatives: using /etc/X11/xinit/xinput.d/fcitx to provide /etc/X11/xinit/xinput.d/zh_CN (xinput-zh_CN) in ae
update-alternatives: using /etc/X11/xinit/xinput.d/fcitx to provide /etc/X11/xinit/xinput.d/zh_TW (xinput-zh_TW) in ae
update-alternatives: using /etc/X11/xinit/xinput.d/fcitx to provide /etc/X11/xinit/xinput.d/zh_HK (xinput-zh_HK) in ae
update-alternatives: using /etc/X11/xinit/xinput.d/fcitx to provide /etc/X11/xinit/xinput.d/zh_SG (xinput-zh_SG) in ae
Setting up libmng1:armhf (1.0.10+dfsg-3.1) ...
Setting up fcitx-ui-classic (1:4.2.9.1-6) ...
Setting up libtiff4:armhf (3.9.7-3) ...
Processing triggers for libc-bin (2.24-11+deb9u1) ...
pi@raspberrypi:~$ 